C51 COMPILER V8.12   F32X_USB_DESCRIPTOR                                                   06/12/2012 19:56:16 PAGE 1   


C51 COMPILER V8.12, COMPILATION OF MODULE F32X_USB_DESCRIPTOR
OBJECT MODULE PLACED IN F32x_USB_Descriptor.OBJ
COMPILER INVOKED BY: C:\Keil\C51\BIN\C51.EXE F32x_USB_Descriptor.c OPTIMIZE(3,SPEED) BROWSE INCDIR(.\Header;.\Lib) DEBUG
                    - OBJECTEXTEND TABS(3)

line level    source

   1          //-----------------------------------------------------------------------------
   2          // F32x_USB_Descriptor.h
   3          //-----------------------------------------------------------------------------
   4          // Copyright 2005 Silicon Laboratories, Inc.
   5          // http://www.silabs.com
   6          // FID:            32X000022
   7          // Target:         C8051F32x
   8          // Tool chain:     Keil C51 7.50 / Keil EVAL C51
   9          // Release 1.3
  10          // Adaptation pour modèle usbhid du cfpt : Neuhaus Jacques ( 30 juin 2010)
  11          //----------------------------------------------------------------------------
  12          
  13          #include "F32x_USB_Descriptor.h"
  14          #include "F32x_USB_Endpoint.h"
  15          
  16          //-----------------------------------------------------------------------------
  17          // Descriptor Declarations
  18          //-----------------------------------------------------------------------------
  19          
  20          const device_descriptor DeviceDesc =
  21          {
  22             18,                  // bLength
  23             0x01,                // bDescriptorType
  24             0x1001,              // bcdUSB
  25             0x00,                // bDeviceClass
  26             0x00,                // bDeviceSubClass
  27             0x00,                // bDeviceProtocol
  28             EP0_PACKET_SIZE,     // bMaxPacketSize0
  29             0xC016,              // idVendor (conservé VID délivré par SiLabs)
  30             0x1020,              // idProduct (PID Année de mise en service)
  31             0x0100,              // bcdDevice (version 1)
  32             0x01,                // iManufacturer
  33             0x02,                // iProduct
  34             0x03,                // iSerialNumber
  35             0x01                 // bNumConfigurations
  36          }; //end of DeviceDesc
  37          
  38          const configuration_descriptor ConfigDesc =
  39          {
  40             0x09,                // Length
  41             0x02,                // Type
  42             0x2900,              // Totallength (Inclus ajout pour HID)
  43                                  // Longueur descripteur Config + Interface + HID + EP x 2
  44             0x01,                // NumInterfaces
  45             0x01,                // bConfigurationValue
  46             0x00,                // iConfiguration
  47             0x80,                // bmAttributes
  48             0x0F                 // MaxPower
  49          }; //end of ConfigDesc
  50          
  51          const interface_descriptor InterfaceDesc =
  52          {
  53             0x09,                // bLength
  54             0x04,                // bDescriptorType
C51 COMPILER V8.12   F32X_USB_DESCRIPTOR                                                   06/12/2012 19:56:16 PAGE 2   

  55             0x00,                // bInterfaceNumber
  56             0x00,                // bAlternateSetting
  57             0x02,                // bNumEndpoints
  58             0x03,                // bInterfaceClass HID
  59             0x00,                // bInterfaceSubClass
  60             0x00,                // bInterfaceProcotol
  61             0x00                 // iInterface
  62          }; //end of InterfaceDesc
  63          
  64          //Descripteur HID
  65          const class_descriptor HidDesc =
  66          {
  67             0x09,     // bLength
  68             0x21,     // bDescriptorType
  69             0x1101,   // bcdHID
  70             0x00,     // bCountryCode
  71             0x01,     // bNumDescriptors
  72             0x22,     // bDescriptorType
  73             HID_REPORT_DESCRIPTOR_SIZE_LE // wItemLength (total length of report descriptor)
  74          };
  75          
  76          // Input Pipe vu du host (pour micro pipe de sortie)
  77          const endpoint_descriptor Endpoint1Desc =
  78          {
  79             0x07,                // bLength
  80             0x05,                // bDescriptorType
  81             0x81,                // bEndpointAddress
  82             0x03,                // bmAttributes
  83             EP1_PACKET_SIZE_LE,  // MaxPacketSize (LITTLE ENDIAN)
  84             10                   // bInterval (Au max. toutes les 10ms)
  85          }; //end of Endpoint1Desc
  86          
  87          // Output Pipe vu du host (pour micro pipe de d'entrée)
  88          const endpoint_descriptor Endpoint2Desc =
  89          {
  90             0x07,                // bLength
  91             0x05,                // bDescriptorType
  92             0x02,                // bEndpointAddress
  93             0x03,                // bmAttributes
  94             EP2_PACKET_SIZE_LE,  // MaxPacketSize (LITTLE ENDIAN)
  95             10                   // bInterval  (Au max. toutes les 10ms)
  96          }; //end of Endpoint2Desc
  97          
  98          // HID Report descriptor 
  99          // Usage propriétaire, trame de 64 x 8bits non signés (bytes)
 100          // Pipe d'entrée et de sortie exploitant chacun une trame 
 101          // de type propriétaire
 102          const hid_report_descriptor HidReportDesc =
 103          {
 104             0x06, 0x00, 0xff,    // USAGE_PAGE (Vendor Defined Page 1)
 105             0x09, 0x01,          // USAGE (Vendor Usage 1)
 106             0xa1, 0x01,          // COLLECTION (Application)
 107             0x09, 0x01,          //   USAGE (Vendor Usage 1)
 108             0x95, 0x40,          //   REPORT_COUNT (64 bytes)
 109             0x75, 0x08,          //   REPORT_SIZE (8 bit)
 110             0x26, 0xff, 0x00,    //   LOGICAL_MAXIMUM (255)
 111             0x15, 0x00,          //   LOGICAL_MINIMUM (0)
 112             0x09, 0x01,          //   USAGE (Vendor Usage 1)
 113             0x81, 0x02,          //   INPUT (Data,Var,Abs)
 114             0x09, 0x01,          //   USAGE (Vendor Usage 1)
 115             0x91, 0x02,          //   OUTPUT (Data,Var,Abs)
 116             0xc0                 //   END_COLLECTION
C51 COMPILER V8.12   F32X_USB_DESCRIPTOR                                                   06/12/2012 19:56:16 PAGE 3   

 117          };
 118          
 119          // String descriptors
 120          
 121          #define STR0LEN 4
 122          
 123          code const BYTE String0Desc[STR0LEN] =
 124          {
 125             STR0LEN, 0x03, 0x09, 0x04
 126          }; //end of String0Desc
 127          
 128          #define STR1LEN sizeof("cfpt-hid")*2
 129          
 130          code const BYTE String1Desc[STR1LEN] =
 131          {
 132             STR1LEN, 0x03,
 133             'c', 0,
 134             'f', 0,
 135             'p', 0,
 136             't', 0,
 137             '-', 0,
 138             'h', 0,
 139             'i', 0,
 140             'd', 0
 141            }; //end of String1Desc
 142          
 143          #define STR2LEN sizeof("Kit-f320-SiLabs")*2
 144          
 145          code const BYTE String2Desc[STR2LEN] =
 146          {
 147             STR2LEN, 0x03,
 148             'K', 0,
 149             'i', 0,
 150             't', 0,
 151             '-', 0,
 152             'f', 0,
 153             '3', 0,
 154             '2', 0,
 155             '0', 0,
 156             '-', 0,
 157             'S', 0,
 158             'i', 0,
 159             'L', 0,
 160             'a', 0,
 161             'b', 0,
 162             's', 0
 163          }; //end of String2Desc
 164          
 165          #define STR3LEN sizeof("Modèle nj")*2
 166          
 167          code const BYTE String3Desc[STR3LEN] =
 168          {
 169             STR2LEN, 0x03,
 170             'M', 0,
 171             'o', 0,
 172             'd', 0,
 173             'è', 0,
 174             'l', 0,
 175             'e', 0,
 176             ' ', 0,
 177             'n', 0,
 178             'j', 0
C51 COMPILER V8.12   F32X_USB_DESCRIPTOR                                                   06/12/2012 19:56:16 PAGE 4   

 179          }; //end of String2Desc
 180          
 181          BYTE* const StringDescTable[] =
 182          {
 183             String0Desc,
 184             String1Desc,
 185             String2Desc,
 186             String3Desc
 187          
 188          };
 189          
 190          #endif


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =   ----    ----
   CONSTANT SIZE    =    160    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     12    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
